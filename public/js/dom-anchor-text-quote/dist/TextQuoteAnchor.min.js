!function(t,e){if("function"==typeof define&&define.amd)define(["exports","module","diff-match-patch","dom-anchor-text-position"],e);else if("undefined"!=typeof exports&&"undefined"!=typeof module)e(exports,module,require("diff-match-patch"),require("dom-anchor-text-position"));else{var n={exports:{}};e(n.exports,n,t.DiffMatchPatch,t.TextPositionAnchor),t.TextQuoteAnchor=n.exports}}(this,function(t,e,n,r){"use strict";function o(t){return t&&t.__esModule?t:{"default":t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=o(n),f=o(r),s=32,h=function(){function t(e,n){var r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(i(this,t),void 0===e)throw new Error('missing required parameter "root"');if(void 0===n)throw new Error('missing required parameter "exact"');this.root=e,this.exact=n,this.prefix=r.prefix,this.suffix=r.suffix}return a(t,[{key:"toRange",value:function(t){return this.toPositionAnchor(t).toRange()}},{key:"toSelector",value:function(){var t={type:"TextQuoteSelector",exact:this.exact};return void 0!==this.prefix&&(t.prefix=this.prefix),void 0!==this.suffix&&(t.suffix=this.suffix),t}},{key:"toPositionAnchor",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.hint,n=this.root,r=new u["default"];r.Match_Distance=2*n.textContent.length;var o=this.exact.match(/(.|[\r\n]){1,32}/g),i=void 0===e?n.textContent.length/2|0:e,a=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,h=-1;void 0!==this.prefix&&(h=r.match_main(n.textContent,this.prefix,i),h>-1&&(i=h+this.prefix.length));var c=o.shift();if(h=r.match_main(n.textContent,c,i),!(h>-1))throw new Error("no match found");a=h,i=s=a+c.length;var m=function(t,e){var o=r.match_main(n.textContent,e,t.loc);if(-1===o)throw new Error("no match found");return t.loc=o+e.length,t.start=Math.min(t.start,o),t.end=Math.max(t.end,o+e.length),t};r.Match_Distance=64;var x=o.reduce(m,{start:a,end:s,loc:i});return new f["default"](n,x.start,x.end)}}],[{key:"fromRange",value:function(t,e){if(void 0===e)throw new Error('missing required parameter "range"');var n=f["default"].fromRange(t,e);return this.fromPositionAnchor(n)}},{key:"fromSelector",value:function(e){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];return new t(e,n.exact,n)}},{key:"fromPositionAnchor",value:function(e){var n=e.root,r=e.start,o=e.end,i=n.textContent.substr(r,o-r),a=Math.max(0,r-s),u=n.textContent.substr(a,r-a),f=Math.min(n.textContent.length,o+s),h=n.textContent.substr(o,f-o);return new t(n,i,{prefix:u,suffix:h})}}]),t}();e.exports=h});
//# sourceMappingURL=TextQuoteAnchor.min.js.map